<frame-page app-title="Notifications" app-icon='fa-bell' white-background='true'>
<div  ng-controller="PortalNotificationController as notificationCtrl">
	<div class="portlet-body notifications">
    <md-tabs md-dynamic-height md-border-bottom>
      <!-- UNSEEN NOTIFICATIONS -->
      <md-tab>
        <md-tab-label>
          New&nbsp;&nbsp;<span class="badge">{{ countWithDismissed() }}</span>
        </md-tab-label>
        <md-tab-body>
          <md-content>
            <md-list class="notifications-list" flex>
              <md-list-item class="secondary-button-padding notification-item"
                            ng-class="{ priority: notification.priority }"
                            ng-repeat="notification in notifications | orderBy:['-priority', '-id']"
                            ng-if="!isDismissed(notification)"
                            layout="row"
                            layout-align="start center">
                <!-- NOTIFICATION TEXT AND ACTION BUTTONS -->
                <a class="md-list-item-text"
                   ng-href="{{ notification.actionURL }}"
                   target="_blank"
                   aria-label="{{ notification.actionAlt }}"
                   layout="row"
                   layout-align="start center"
                   layout-xs="column"
                   layout-align-xs="center start">
                  <span><i class="fa fa-exclamation-triangle" ng-if="notification.priority"></i> {{ notification.title }}</span>
                  <div ng-if="notification.actionButtons && notification.actionButtons.length > 0" class="notification-buttons"
                       layout-xs="column" layout-align-xs="center start">
                    <md-button class="md-raised"
                               ng-href="{{button.url}}"
                               ng-repeat="button in notification.actionButtons track by button.label"
                               ng-class="{'md-primary' : $index === 0, 'md-accent' : $index > notification.buttonText.length / 2 - 1}"
                               ng-click="button.action"
                               target="{{button.target}}"
                               aria-label="{{button.label}}">
                      {{button.label}}
                    </md-button>
                  </div>
                </a>
                <!-- DISMISS BUTTON -->
                <md-button class="md-icon-button md-secondary"
                           ng-click="dismiss(notification)"
                           ng-hide="!notification.dismissable || isDismissed(notification)"
                           aria-label="dismiss this notification">
                  <i class='fa fa-times'></i>
                </md-button>
              </md-list-item>
              <!-- IF NO NOTIFICATIONS -->
              <md-list-item class="notification-item read"
                            ng-if="isEmpty || (countWithDismissed() === 0)">No new notifications
              </md-list-item>
            </md-list>
          </md-content>
        </md-tab-body>
      </md-tab>
      <!-- DISMISSED NOTIFICATIONS TAB -->
      <md-tab>
        <md-tab-label>
          Dismissed&nbsp;&nbsp;<span class="badge">{{ dismissedCount() }}</span>
        </md-tab-label>
        <md-tab-body>
          <md-content>
            <md-list class="notifications-list" flex>
              <md-list-item class="secondary-button-padding notification-item"
                            ng-class="{ priority: notification.priority }"
                            ng-repeat="notification in notifications | orderBy:['-priority', '-id']"
                            ng-if="isDismissed(notification)"
                            layout="row"
                            layout-align="start center">
                <!-- NOTIFICATION TEXT AND ACTION BUTTONS -->
                <a class="md-list-item-text"
                   ng-href="{{ notification.actionURL }}"
                   target="_blank"
                   aria-label="{{ notification.actionAlt }}"
                   layout="row"
                   layout-align="start center"
                   layout-xs="column"
                   layout-align-xs="center start">
                  <span><i class="fa fa-exclamation-triangle" ng-if="notification.priority"></i> {{ notification.title }}</span>
                  <div ng-if="notification.actionButtons && notification.actionButtons.length > 0" class="notification-buttons"
                       layout-xs="column" layout-align-xs="center start">
                    <md-button class="md-raised"
                               ng-href="{{button.url}}"
                               ng-repeat="button in notification.actionButtons track by button.label"
                               ng-class="{'md-primary' : $index === 0, 'md-accent' : $index > notification.buttonText.length / 2 - 1}"
                               ng-click="button.action"
                               target="{{button.target}}"
                               aria-label="{{button.label}}">
                      {{button.label}}
                    </md-button>
                  </div>
                </a>
                <!-- RESTORE BUTTON -->
                <md-button class="md-icon-button md-secondary"
                           ng-click="undismiss(notification)"
                           aria-label="restore this notification">
                  <i class='fa fa-undo'></i>
                </md-button>
              </md-list-item>
              <!-- IF NO NOTIFICATIONS -->
              <md-list-item class="notification-item read" ng-if="dismissedCount() === 0">
                No dismissed notifications
              </md-list-item>
            </md-list>
          </md-content>
        </md-tab-body>
      </md-tab>
    </md-tabs>
  </div>
</div>
</frame-page>
